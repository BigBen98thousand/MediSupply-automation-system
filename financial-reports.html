<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Reports - MediSupply Hub</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #2c5530; --primary-light: #4a7856; --secondary: #f8f9fa;
            --accent: #e63946; --text: #333; --text-light: #6c757d; --border: #dee2e6;
            --success: #28a745; --warning: #ffc107; --danger: #dc3545;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f8f9fa; color: var(--text); }
        
        /* Navigation */
        .navbar {
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 1rem;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }
        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        .nav-logo h1 { color: var(--primary); font-size: 1.2rem; }
        .nav-menu { display: flex; gap: 0.5rem; flex-wrap: wrap; }
        .nav-link { text-decoration: none; color: var(--text); padding: 0.5rem 0.75rem; border-radius: 4px; transition: all 0.3s ease; font-size: 0.9rem; }
        .nav-link:hover, .nav-link.active { background: var(--primary); color: white; }
        .hamburger { display: none; flex-direction: column; cursor: pointer; padding: 0.25rem; }
        .hamburger span { width: 25px; height: 3px; background: var(--primary); margin: 3px 0; transition: 0.3s; border-radius: 2px; }
        
        .main-content { max-width: 1400px; margin: 5rem auto 2rem; padding: 0 1rem; }
        .filters { background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 1.5rem; }
        .filter-group { display: flex; gap: 1rem; margin-bottom: 1rem; flex-wrap: wrap; }
        .filter-group select, .filter-group input { padding: 0.5rem; border: 1px solid var(--border); border-radius: 4px; font-size: 0.9rem; }
        .btn { padding: 0.6rem 1.2rem; border: none; border-radius: 4px; cursor: pointer; text-decoration: none; display: inline-block; text-align: center; font-size: 0.9rem; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-secondary { background: var(--secondary); color: var(--text); border: 1px solid var(--border); }
        .report-section { background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 1.5rem; }
        table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
        th, td { padding: 0.8rem; text-align: left; border-bottom: 1px solid var(--border); font-size: 0.9rem; }
        th { background: var(--secondary); font-weight: 600; }
        .amount { text-align: right; }
        .positive { color: var(--success); }
        .negative { color: var(--danger); }
        .report-summary { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; }
        .summary-card { background: white; padding: 1rem; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); text-align: center; }
        .summary-card h3 { color: var(--text-light); font-size: 0.8rem; margin-bottom: 0.5rem; }
        .summary-card .value { font-size: 1.2rem; font-weight: bold; color: var(--primary); }
        
        /* Modal Styles */
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); }
        .modal-content { background: white; margin: 5% auto; padding: 1.5rem; border-radius: 8px; width: 95%; max-width: 500px; max-height: 90vh; overflow-y: auto; }
        .form-group { margin-bottom: 1rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; font-size: 0.9rem; }
        .form-group input { width: 100%; padding: 0.75rem; border: 1px solid var(--border); border-radius: 4px; font-size: 0.9rem; }
        
        /* Mobile Styles */
        @media (max-width: 768px) {
            .hamburger { display: flex; }
            .nav-menu { position: fixed; left: -100%; top: 70px; flex-direction: column; background: white; width: 100%; text-align: center; transition: 0.3s; box-shadow: 0 10px 27px rgba(0,0,0,0.05); padding: 2rem 0; gap: 0; }
            .nav-menu.active { left: 0; }
            .nav-link { display: block; padding: 1rem; border-bottom: 1px solid var(--border); border-radius: 0; }
            .nav-link:hover, .nav-link.active { background: var(--primary); color: white; }
            .hamburger.active span:nth-child(1) { transform: rotate(-45deg) translate(-5px, 6px); }
            .hamburger.active span:nth-child(2) { opacity: 0; }
            .hamburger.active span:nth-child(3) { transform: rotate(45deg) translate(-5px, -6px); }
            .filter-group { flex-direction: column; }
            .report-summary { grid-template-columns: 1fr 1fr; }
            .report-section { padding: 1rem; }
            .main-content { margin-top: 5rem; padding: 0 0.5rem; }
        }
        @media (max-width: 480px) {
            .nav-logo h1 { font-size: 1rem; }
            .nav-link { padding: 0.8rem; font-size: 0.9rem; }
            .main-content { padding: 0 0.5rem; }
            .report-summary { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo"><h1>üè• MediSupply Accounting</h1></div>
            
            <div class="nav-menu" id="nav-menu">
                <a href="index.html" class="nav-link">Dashboard</a>
                <a href="journal-entries.html" class="nav-link">Journal</a>
                <a href="general-ledger.html" class="nav-link">Ledger</a>
                <a href="invoices.html" class="nav-link">Sales</a>
                <a href="expenses.html" class="nav-link">Expenses</a>
                <a href="inventory.html" class="nav-link">Inventory</a>
                <a href="financial-reports.html" class="nav-link active">Reports</a>
            </div>

            <div class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <main class="main-content">
        <h2 style="margin-bottom: 1.5rem;">Financial Reports</h2>

        <div class="filters">
            <div class="filter-group">
                <select id="report-type">
                    <option value="balance-sheet">Balance Sheet</option>
                    <option value="income-statement">Income Statement</option>
                    <option value="cash-flow">Cash Flow Statement</option>
                </select>
                <input type="month" id="report-month" value="">
                <button class="btn btn-primary" onclick="loadFinancialReports()">Generate Report</button>
                <button class="btn btn-secondary" onclick="printReport()">Print Report</button>
            </div>
        </div>

        <div class="report-summary" id="report-summary">
            <!-- Summary cards will be loaded here -->
        </div>

        <div class="report-section">
            <h3 id="report-title">Balance Sheet</h3>
            <div id="balance-sheet-report">
                <!-- Balance sheet will be loaded here -->
            </div>
            <div id="income-statement-report" style="display: none;">
                <!-- Income statement will be loaded here -->
            </div>
            <div id="cash-flow-report" style="display: none;">
                <!-- Cash flow statement will be loaded here -->
            </div>
        </div>
    </main>

    <!-- Reset Data Modal -->
    <div id="reset-modal" class="modal">
        <div class="modal-content">
            <span style="float: right; font-size: 1.5rem; cursor: pointer;" onclick="hideResetModal()">&times;</span>
            <h3 style="color: var(--danger);">‚ö†Ô∏è Reset All Data</h3>
            <p><strong>Warning:</strong> This will permanently delete ALL your data including:</p>
            <ul style="margin: 1rem 0; padding-left: 1.5rem;">
                <li>All expenses and sales records</li>
                <li>All journal entries and ledger data</li>
                <li>All inventory items</li>
                <li>All financial reports</li>
            </ul>
            <p>This action cannot be undone!</p>
            <div class="form-group">
                <label for="confirm-reset">Type "RESET" to confirm:</label>
                <input type="text" id="confirm-reset" placeholder="Type RESET here">
            </div>
            <div class="form-actions" style="margin-top: 1rem; text-align: right;">
                <button type="button" class="btn-secondary" onclick="hideResetModal()">Cancel</button>
                <button type="button" class="btn-danger" onclick="confirmReset()" id="reset-btn" disabled>Reset All Data</button>
            </div>
        </div>
    </div>

    <script src="firebase-config.js"></script>
    <script>
        // Hamburger menu functionality
        document.addEventListener('DOMContentLoaded', function() {
            const hamburger = document.getElementById('hamburger');
            const navMenu = document.getElementById('nav-menu');

            hamburger.addEventListener('click', function() {
                hamburger.classList.toggle('active');
                navMenu.classList.toggle('active');
            });

            // Close menu when clicking on a link
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', function() {
                    hamburger.classList.remove('active');
                    navMenu.classList.remove('active');
                });
            });

            // Load initial data
            setDefaultMonth();
            loadFinancialReports();

            // Add reset button
            addResetButton();

            // Add reset confirmation input listener
            document.getElementById('confirm-reset').addEventListener('input', function() {
                document.getElementById('reset-btn').disabled = this.value !== 'RESET';
            });
        });

        function setDefaultMonth() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            document.getElementById('report-month').value = year + '-' + month;
        }

        function loadFinancialReports() {
            const reportType = document.getElementById('report-type').value;
            const reportMonth = document.getElementById('report-month').value;

            // Hide all reports first
            document.getElementById('balance-sheet-report').style.display = 'none';
            document.getElementById('income-statement-report').style.display = 'none';
            document.getElementById('cash-flow-report').style.display = 'none';

            if (reportType === 'balance-sheet') {
                loadBalanceSheet();
                document.getElementById('balance-sheet-report').style.display = 'block';
                document.getElementById('report-title').textContent = 'Balance Sheet - As of ' + new Date().toLocaleDateString();
            } else if (reportType === 'income-statement') {
                loadIncomeStatement(reportMonth);
                document.getElementById('income-statement-report').style.display = 'block';
                document.getElementById('report-title').textContent = 'Income Statement - ' + new Date(reportMonth + '-01').toLocaleDateString('en', {year: 'numeric', month: 'long'});
            } else if (reportType === 'cash-flow') {
                loadCashFlowStatement(reportMonth);
                document.getElementById('cash-flow-report').style.display = 'block';
                document.getElementById('report-title').textContent = 'Cash Flow Statement - ' + new Date(reportMonth + '-01').toLocaleDateString('en', {year: 'numeric', month: 'long'});
            }
        }

        async function loadBalanceSheet() {
            try {
                // Get cash account
                const cashDoc = await db.collection('companies').doc(COMPANY_ID).collection('chart_of_accounts').doc('1001').get();
                const capitalDoc = await db.collection('companies').doc(COMPANY_ID).collection('chart_of_accounts').doc('3001').get();
                
                let cashBalance = 0;
                let capitalBalance = 0;

                if (cashDoc.exists) {
                    cashBalance = cashDoc.data().balance || 0;
                }

                if (capitalDoc.exists) {
                    capitalBalance = capitalDoc.data().balance || 0;
                }

                // Calculate revenue and expenses from journal entries for net income
                const journalSnapshot = await db.collection('companies').doc(COMPANY_ID).collection('journal_entries').get();
                let totalRevenue = 0;
                let totalExpenses = 0;

                journalSnapshot.forEach(doc => {
                    const entry = doc.data();
                    entry.lineItems.forEach(item => {
                        if (item.accountType === 'revenue') {
                            totalRevenue += item.credit || 0;
                        } else if (item.accountType === 'expense') {
                            totalExpenses += item.debit || 0;
                        }
                    });
                });

                const netIncome = totalRevenue - totalExpenses;
                const totalEquity = capitalBalance + netIncome;
                const totalAssets = cashBalance;
                const totalLiabilities = 0; // Assuming no liabilities for simplicity

                // Update summary
                document.getElementById('report-summary').innerHTML = 
                    '<div class="summary-card"><h3>Total Assets</h3><div class="value">‚Ç¶' + totalAssets.toLocaleString() + '</div></div>' +
                    '<div class="summary-card"><h3>Total Liabilities</h3><div class="value">‚Ç¶' + totalLiabilities.toLocaleString() + '</div></div>' +
                    '<div class="summary-card"><h3>Total Equity</h3><div class="value">‚Ç¶' + totalEquity.toLocaleString() + '</div></div>' +
                    '<div class="summary-card"><h3>Net Income</h3><div class="value ' + (netIncome >= 0 ? 'positive' : 'negative') + '">‚Ç¶' + netIncome.toLocaleString() + '</div></div>';

                // Build balance sheet HTML
                let balanceSheetHTML = '<table><tr><th>Assets</th><th class="amount">Amount</th></tr>';
                balanceSheetHTML += '<tr><td>Cash</td><td class="amount">‚Ç¶' + cashBalance.toLocaleString() + '</td></tr>';
                balanceSheetHTML += '<tr><td><strong>Total Assets</strong></td><td class="amount"><strong>‚Ç¶' + totalAssets.toLocaleString() + '</strong></td></tr>';
                
                balanceSheetHTML += '</table><table><tr><th>Liabilities & Equity</th><th class="amount">Amount</th></tr>';
                balanceSheetHTML += '<tr><td><strong>Liabilities</strong></td><td class="amount"></td></tr>';
                balanceSheetHTML += '<tr><td>No liabilities recorded</td><td class="amount">‚Ç¶0</td></tr>';
                balanceSheetHTML += '<tr><td><strong>Total Liabilities</strong></td><td class="amount"><strong>‚Ç¶' + totalLiabilities.toLocaleString() + '</strong></td></tr>';
                
                balanceSheetHTML += '<tr><td><strong>Equity</strong></td><td class="amount"></td></tr>';
                balanceSheetHTML += '<tr><td>Owner\'s Capital</td><td class="amount">‚Ç¶' + capitalBalance.toLocaleString() + '</td></tr>';
                balanceSheetHTML += '<tr><td>Retained Earnings (Net Income)</td><td class="amount">‚Ç¶' + netIncome.toLocaleString() + '</td></tr>';
                balanceSheetHTML += '<tr><td><strong>Total Equity</strong></td><td class="amount"><strong>‚Ç¶' + totalEquity.toLocaleString() + '</strong></td></tr>';
                
                balanceSheetHTML += '<tr><td><strong>Total Liabilities & Equity</strong></td><td class="amount"><strong>‚Ç¶' + (totalLiabilities + totalEquity).toLocaleString() + '</strong></td></tr>';
                balanceSheetHTML += '</table>';
                
                const equationBalanced = Math.abs(totalAssets - (totalLiabilities + totalEquity)) < 0.01;
                balanceSheetHTML += '<div style="margin-top: 1rem; padding: 1rem; background: ' + (equationBalanced ? '#d4edda' : '#f8d7da') + '; color: ' + (equationBalanced ? '#155724' : '#721c24') + '; border-radius: 4px; text-align: center; font-weight: bold;">' +
                    'Accounting Equation: ' + (equationBalanced ? 'BALANCED ‚úì' : 'UNBALANCED ‚úó') + '</div>';

                document.getElementById('balance-sheet-report').innerHTML = balanceSheetHTML;
            } catch (error) {
                console.error('Error loading balance sheet:', error);
                document.getElementById('balance-sheet-report').innerHTML = '<p style="color: var(--danger); text-align: center;">Error loading balance sheet. Please reset your data.</p>';
            }
        }

        async function loadIncomeStatement(month) {
            try {
                const [year, monthNum] = month.split('-');
                const startDate = new Date(year, monthNum - 1, 1);
                const endDate = new Date(year, monthNum, 0);
                endDate.setHours(23, 59, 59, 999);

                let totalRevenue = 0;
                let totalExpenses = 0;

                // Calculate revenue from invoices
                const invoiceSnapshot = await db.collection('companies').doc(COMPANY_ID).collection('invoices')
                    .where('date', '>=', startDate)
                    .where('date', '<=', endDate)
                    .get();

                invoiceSnapshot.forEach(doc => {
                    totalRevenue += doc.data().totalAmount || 0;
                });

                // Calculate expenses from journal entries
                const journalSnapshot = await db.collection('companies').doc(COMPANY_ID).collection('journal_entries')
                    .where('date', '>=', startDate)
                    .where('date', '<=', endDate)
                    .get();

                journalSnapshot.forEach(doc => {
                    const entry = doc.data();
                    entry.lineItems.forEach(item => {
                        if (item.accountType === 'expense') {
                            totalExpenses += item.amount || 0;
                        }
                    });
                });

                const netIncome = totalRevenue - totalExpenses;

                // Update summary
                document.getElementById('report-summary').innerHTML = 
                    '<div class="summary-card"><h3>Total Revenue</h3><div class="value">‚Ç¶' + totalRevenue.toLocaleString() + '</div></div>' +
                    '<div class="summary-card"><h3>Total Expenses</h3><div class="value">‚Ç¶' + totalExpenses.toLocaleString() + '</div></div>' +
                    '<div class="summary-card"><h3>Net Income</h3><div class="value ' + (netIncome >= 0 ? 'positive' : 'negative') + '">‚Ç¶' + netIncome.toLocaleString() + '</div></div>';

                // Build income statement HTML
                let incomeHTML = '<table>';
                incomeHTML += '<tr><td><strong>Revenue</strong></td><td class="amount"></td></tr>';
                incomeHTML += '<tr><td>Medical Supplies Sales</td><td class="amount">‚Ç¶' + totalRevenue.toLocaleString() + '</td></tr>';
                incomeHTML += '<tr><td><strong>Total Revenue</strong></td><td class="amount"><strong>‚Ç¶' + totalRevenue.toLocaleString() + '</strong></td></tr>';
                
                incomeHTML += '<tr><td><strong>Expenses</strong></td><td class="amount"></td></tr>';
                incomeHTML += '<tr><td>All Operating Expenses</td><td class="amount">‚Ç¶' + totalExpenses.toLocaleString() + '</td></tr>';
                incomeHTML += '<tr><td><strong>Total Expenses</strong></td><td class="amount"><strong>‚Ç¶' + totalExpenses.toLocaleString() + '</strong></td></tr>';
                
                incomeHTML += '<tr><td><strong>Net Income</strong></td><td class="amount"><strong class="' + (netIncome >= 0 ? 'positive' : 'negative') + '">‚Ç¶' + netIncome.toLocaleString() + '</strong></td></tr>';
                incomeHTML += '</table>';

                document.getElementById('income-statement-report').innerHTML = incomeHTML;
            } catch (error) {
                console.error('Error loading income statement:', error);
                document.getElementById('income-statement-report').innerHTML = '<p style="color: var(--danger); text-align: center;">Error loading income statement.</p>';
            }
        }

        async function loadCashFlowStatement(month) {
            try {
                const [year, monthNum] = month.split('-');
                const startDate = new Date(year, monthNum - 1, 1);
                const endDate = new Date(year, monthNum, 0);
                endDate.setHours(23, 59, 59, 999);

                let cashFromOperations = 0;

                // Calculate cash flow from operations (simplified)
                const journalSnapshot = await db.collection('companies').doc(COMPANY_ID).collection('journal_entries')
                    .where('date', '>=', startDate)
                    .where('date', '<=', endDate)
                    .get();

                journalSnapshot.forEach(doc => {
                    const entry = doc.data();
                    entry.lineItems.forEach(item => {
                        if (item.accountCode === '1001') { // Cash account
                            if (item.debit > 0) {
                                cashFromOperations += item.debit;
                            } else if (item.credit > 0) {
                                cashFromOperations -= item.credit;
                            }
                        }
                    });
                });

                const netCashFlow = cashFromOperations;

                // Update summary
                document.getElementById('report-summary').innerHTML = 
                    '<div class="summary-card"><h3>Cash from Operations</h3><div class="value ' + (cashFromOperations >= 0 ? 'positive' : 'negative') + '">‚Ç¶' + cashFromOperations.toLocaleString() + '</div></div>' +
                    '<div class="summary-card"><h3>Net Cash Flow</h3><div class="value ' + (netCashFlow >= 0 ? 'positive' : 'negative') + '">‚Ç¶' + netCashFlow.toLocaleString() + '</div></div>';

                // Build cash flow statement HTML
                let cashFlowHTML = '<table>';
                cashFlowHTML += '<tr><td><strong>Cash flows from operating activities:</strong></td><td class="amount"></td></tr>';
                cashFlowHTML += '<tr><td>Net cash provided by operations</td><td class="amount">‚Ç¶' + cashFromOperations.toLocaleString() + '</td></tr>';
                cashFlowHTML += '<tr><td><strong>Net cash from operations</strong></td><td class="amount"><strong class="' + (cashFromOperations >= 0 ? 'positive' : 'negative') + '">‚Ç¶' + cashFromOperations.toLocaleString() + '</strong></td></tr>';
                
                cashFlowHTML += '<tr><td><strong>Net increase in cash</strong></td><td class="amount"><strong class="' + (netCashFlow >= 0 ? 'positive' : 'negative') + '">‚Ç¶' + netCashFlow.toLocaleString() + '</strong></td></tr>';
                cashFlowHTML += '</table>';

                document.getElementById('cash-flow-report').innerHTML = cashFlowHTML;
            } catch (error) {
                console.error('Error loading cash flow statement:', error);
                document.getElementById('cash-flow-report').innerHTML = '<p style="color: var(--danger); text-align: center;">Error loading cash flow statement.</p>';
            }
        }

        function printReport() {
            window.print();
        }

        // Reset functionality
        function addResetButton() {
            if (!document.getElementById('reset-data-btn')) {
                const resetBtn = document.createElement('button');
                resetBtn.id = 'reset-data-btn';
                resetBtn.className = 'btn btn-danger';
                resetBtn.style.position = 'fixed';
                resetBtn.style.bottom = '20px';
                resetBtn.style.right = '20px';
                resetBtn.style.zIndex = '1000';
                resetBtn.textContent = 'üîÑ Reset Data';
                resetBtn.onclick = showResetModal;
                document.body.appendChild(resetBtn);
            }
        }

        function showResetModal() {
            document.getElementById('reset-modal').style.display = 'block';
            document.getElementById('confirm-reset').value = '';
            document.getElementById('reset-btn').disabled = true;
        }

        function hideResetModal() {
            document.getElementById('reset-modal').style.display = 'none';
        }

        function confirmReset() {
            resetAllData();
        }

        async function resetAllData() {
            try {
                // Delete all expenses
                const expensesSnapshot = await db.collection('companies').doc(COMPANY_ID).collection('expenses').get();
                const expenseDeletes = expensesSnapshot.docs.map(doc => doc.ref.delete());
                
                // Delete all journal entries
                const journalSnapshot = await db.collection('companies').doc(COMPANY_ID).collection('journal_entries').get();
                const journalDeletes = journalSnapshot.docs.map(doc => doc.ref.delete());
                
                // Delete all inventory
                const inventorySnapshot = await db.collection('companies').doc(COMPANY_ID).collection('inventory').get();
                const inventoryDeletes = inventorySnapshot.docs.map(doc => doc.ref.delete());
                
                // Delete all invoices
                const invoicesSnapshot = await db.collection('companies').doc(COMPANY_ID).collection('invoices').get();
                const invoiceDeletes = invoicesSnapshot.docs.map(doc => doc.ref.delete());
                
                // Wait for all deletions to complete
                await Promise.all([...expenseDeletes, ...journalDeletes, ...inventoryDeletes, ...invoiceDeletes]);
                
                // Reset chart of accounts with seed capital
                const cashAccountRef = db.collection('companies').doc(COMPANY_ID).collection('chart_of_accounts').doc('1001');
                const capitalAccountRef = db.collection('companies').doc(COMPANY_ID).collection('chart_of_accounts').doc('3001');
                
                await cashAccountRef.set({
                    code: '1001',
                    name: 'Cash',
                    type: 'asset',
                    balance: 5000000,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                await capitalAccountRef.set({
                    code: '3001',
                    name: 'Owner\'s Capital',
                    type: 'equity',
                    balance: 5000000,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                hideResetModal();
                alert('All data reset successfully! ‚Ç¶5,000,000 seed capital has been set.');
                loadFinancialReports();
            } catch (error) {
                console.error('Error resetting data:', error);
                alert('Error resetting data: ' + error.message);
            }
        }
    </script>
</body>
    </html>
